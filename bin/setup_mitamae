#! /bin/sh
set -e

version='1.0.0'

case "$(uname)" in
  "Darwin")
    mitamae_bin="mitamae-x86_64-darwin"
    ;;
  "Linux")
    mitamae_bin="mitamae-x86_64-linux"
    ;;
  *)
    echo "unknown uname: $(uname)"
    exit 1
    ;;
esac

mitamae_gz="${mitamae_bin}.tar.gz"
mitamae_invoke="${mitamae_bin}-${version}-invoke"
# http://www.hcn.zaq.ne.jp/___/unix/curl_manual.html
curl -o "bin/${mitamae_gz}" -fL "https://github.com/k0kubun/mitamae/releases/download/v${version}/${mitamae_bin}.tar.gz"
tar xvzf "bin/${mitamae_gz}"
rm "bin/${mitamae_gz}"
mv "${mitamae_bin}" "bin/${mitamae_invoke}"
chmod +x "bin/${mitamae_invoke}"
ln -sf "bin/${mitamae_invoke}" bin/mitamae
